define ("block_poodllclassroom/blockcontroller",["jquery","core/config","core/log","core/ajax","core/templates","core/modal_factory","core/str","core/modal_events","block_poodllclassroom/dialogs","block_poodllclassroom/modalformhelper","block_poodllclassroom/modaldeletehelper","core/notification"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";c.debug("blockcontroller: initialising");return{controls:{},modulecssclass:null,contextid:0,strings:[],init:function init(a){this.modulecssclass=a.modulecssclass;this.contextid=a.contextid;this.prepare_html();this.register_events()},init_strings:function init_strings(){for(var a=this,b=["createcourse"],c=0;c<b.length;c++){g.get_string(b[c],"block_poodllclassroom").then(function(b){a.strings[c]=b})}},prepare_html:function prepare_html(){this.controls.createuserstartbutton=a("#"+this.modulecssclass+"_createuser_btn");this.controls.createcoursestartbutton=a("#"+this.modulecssclass+"_createcourse_btn");this.controls.createcoursestartcontainer=a("#"+this.modulecssclass+"_createcourse_cnt");this.controls.createcoursestartbutton.show();c.debug(this.controls)},register_events:function register_events(){this;j.init("#"+this.modulecssclass+"_createuser_btn",this.contextid,"createuser");j.init("#"+this.modulecssclass+"_createcourse_btn",this.contextid,"createcourse");j.init("."+this.modulecssclass+"_usereditlink",this.contextid,"edituser");j.init("."+this.modulecssclass+"_courseeditlink",this.contextid,"editcourse");var a=function(a){c.debug("all done:"+a)};k.init("."+this.modulecssclass+"_coursedeletelink",this.contextid,"deletecourse",a);k.init("."+this.modulecssclass+"_userdeletelink",this.contextid,"deleteuser",a)},do_resetkey:function do_resetkey(a,e){d.call([{methodname:"block_poodllclassroom_reset_key",args:{moduleid:e},done:function done(d){var e=JSON.parse(d);if(e){switch(e.success){case!0:var f=e.message;a.controls.sharebox.val(b.wwwroot+"/mod/cpassignment/k.php?k="+f);break;case!1:default:if(e.message){c.debug("message: "+e.message)}}}},fail:l.exception}])},do_delete:function do_delete(a){d.call([{methodname:"block_poodllclassroom_remove_rec",args:{itemid:a},done:function done(a){var b=JSON.parse(a);if(b){switch(b.success){case!0:break;case!1:default:if(b.message){c.debug("message: "+b.message)}}}},fail:l.exception}])},insert_new_item:function insert_new_item(b,c){b.controls.noitemscontainer.hide();b.controls.itemscontainer.show();e.render("block_poodllclassroom/userlistrow",c).then(function(c){b.controls.thedatatable.row.add(a(c)[0]).draw()})},send_submission:function send_submission(a,b,e,f){var g=this,h={subid:a,filename:b,itemname:f,itemid:e,cmid:g.cmid};if("guest"===this.authmode){h.accesskey=g.accesskey}else{h.accesskey="none"}d.call([{methodname:"block_poodllclassroom_submit_rec",args:h,done:function done(a){var b=JSON.parse(a);if(b){switch(b.success){case!0:var d=b.item;if("guest"===g.authmode){g.acknowledge_receipt(g,d)}else{g.insert_new_item(g,d);g.check_item_count(g)}i.closeModal("#"+g.modulecssclass+"_arec_container");g.re_init_recorder(g,g.audiorecid);break;case!1:default:if(b.message){c.debug("message: "+b.message)}i.closeModal("#"+g.modulecssclass+"_arec_container");g.clear_recorder();g.re_init_recorder(g.audiorecid);}}},fail:l.exception}])}}});
//# sourceMappingURL=blockcontroller.min.js.map
