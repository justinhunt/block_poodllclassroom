{"version":3,"sources":["../src/chargebeehelper.js"],"names":["define","$","log","ajax","debug","instanceprops","changeplanclass","siteprefix","controls","init","props","registercontrols","registerevents","togglebutton","monthlyplans","yearlyplans","that","on","event","preventDefault","toggle","getScript","chargebee","Chargebee","planid","data","openCheckout","hostedPage","promises","call","methodname","args","loaded","console","error","close","success","hostedPageId","step","value"],"mappings":"AACAA,OAAM,yCAAC,CAAC,QAAD,CAAU,UAAV,CAAqB,WAArB,CAAD,CAAoC,SAASC,CAAT,CAAYC,CAAZ,CAAiBC,CAAjB,CAAuB,CAE7D,aACAD,CAAG,CAACE,KAAJ,CAAU,wBAAV,EAEA,MAAO,CAEHC,aAAa,CAAE,IAFZ,CAGHC,eAAe,CAAE,EAHd,CAIHC,UAAU,CAAE,EAJT,CAKHC,QAAQ,CAAE,EALP,CAQHC,IAAI,CAAE,cAASC,CAAT,CAAe,CAEjB,KAAKL,aAAL,CAAmBK,CAAnB,CACA,KAAKJ,eAAL,CAAqBI,CAAK,CAACJ,eAA3B,CACA,KAAKC,UAAL,CAAgBG,CAAK,CAACH,UAAtB,CACA,KAAKI,gBAAL,GACA,KAAKC,cAAL,EACH,CAfE,CAiBHD,gBAAgB,CAAE,2BAAU,CACxB,KAAKH,QAAL,CAAcK,YAAd,CAA6BZ,CAAC,CAAC,iBAAD,CAA9B,CACA,KAAKO,QAAL,CAAcM,YAAd,CAA6Bb,CAAC,CAAC,aAAD,CAA9B,CACA,KAAKO,QAAL,CAAcO,WAAd,CAA4Bd,CAAC,CAAC,YAAD,CAChC,CArBE,CAuBHW,cAAc,CAAE,yBAAW,CACvB,GAAII,CAAAA,CAAI,CAAG,IAAX,CAGA,KAAKR,QAAL,CAAcK,YAAd,CAA2BI,EAA3B,CAA8B,OAA9B,CAAsC,UAAU,CAC5CC,KAAK,CAACC,cAAN,GACAH,CAAI,CAACR,QAAL,CAAcM,YAAd,CAA2BM,MAA3B,GACAJ,CAAI,CAACR,QAAL,CAAcO,WAAd,CAA0BK,MAA1B,EACH,CAJD,EAOAnB,CAAC,CAACoB,SAAF,CAAY,0CAAZ,CAAwD,UAAU,CAC9D,GAAIC,CAAAA,CAAS,CAAGC,SAAS,CAACd,IAAV,CAAe,CAAC,KAAQO,CAAI,CAACT,UAAd,CAAf,CAAhB,CACAN,CAAC,CAAC,IAAMe,CAAI,CAACV,eAAZ,CAAD,CAA8BW,EAA9B,CAAiC,OAAjC,CAA0C,UAAW,CACjDC,KAAK,CAACC,cAAN,GACA,GAAIK,CAAAA,CAAM,CAAGvB,CAAC,CAAC,IAAD,CAAD,CAAQwB,IAAR,CAAa,QAAb,CAAb,CACAH,CAAS,CAACI,YAAV,CAAuB,CACnBC,UAAU,CAAE,qBAAW,CAMnB,GAAIC,CAAAA,CAAQ,CAAGzB,CAAI,CAAC0B,IAAL,CAAU,CAAC,CACtBC,UAAU,CAAE,6CADU,CAEtBC,IAAI,CAAE,CAACP,MAAM,CAAEA,CAAT,CAFgB,CAAD,CAAV,CAAf,CAIA,MAAOI,CAAAA,CAAQ,CAAC,CAAD,CAClB,CAZkB,CAanBI,MAAM,CAAE,iBAAW,CACfC,OAAO,CAAC/B,GAAR,CAAY,iBAAZ,CACH,CAfkB,CAgBnBgC,KAAK,CAAE,gBAAW,CACjB,CAjBkB,CAkBnBC,KAAK,CAAE,gBAAW,CACdF,OAAO,CAAC/B,GAAR,CAAY,iBAAZ,CACH,CApBkB,CAqBnBkC,OAAO,CAAE,iBAASC,CAAT,CAAuB,CAC5BJ,OAAO,CAAC/B,GAAR,CAAYmC,CAAZ,CAKH,CA3BkB,CA4BnBC,IAAI,CAAE,cAASC,CAAT,CAAgB,CAElBN,OAAO,CAAC/B,GAAR,CAAYqC,CAAZ,CACH,CA/BkB,CAAvB,CAiCH,CApCD,CAsCH,CAxCD,CA4CH,CA9EE,CAgFV,CArFK,CAAN","sourcesContent":["/* jshint ignore:start */\ndefine(['jquery','core/log','core/ajax'], function($, log, ajax) {\n\n    \"use strict\";\n    log.debug('cbhelper: initialising');\n\n    return {\n\n        instanceprops: null,\n        changeplanclass: '',\n        siteprefix: '',\n        controls: {},\n\n        //pass in config, and register any events\n        init: function(props){\n            //log.debug(props);\n            this.instanceprops=props;\n            this.changeplanclass=props.changeplanclass;\n            this.siteprefix=props.siteprefix;\n            this.registercontrols();\n            this.registerevents();\n        },\n\n        registercontrols: function(){\n            this.controls.togglebutton = $('a.monthlyyearly');\n            this.controls.monthlyplans = $('div.monthly');\n            this.controls.yearlyplans = $('div.yearly');\n        },\n\n        registerevents: function() {\n            var that = this;\n\n            //set up toggle button\n            this.controls.togglebutton.on('click',function(){\n                event.preventDefault();\n                that.controls.monthlyplans.toggle();\n                that.controls.yearlyplans.toggle();\n            });\n\n            //set up checkout links\n            $.getScript('https://js.chargebee.com/v2/chargebee.js', function(){\n                var chargebee = Chargebee.init({'site': that.siteprefix});\n                $(\".\" + that.changeplanclass).on(\"click\", function() {\n                    event.preventDefault();\n                    var planid = $(this).data('planid');\n                    chargebee.openCheckout({\n                        hostedPage: function() {\n                            // Hit your end point that returns hosted page object as response\n                            // This sample end point will call checkout new api\n                            // https://apidocs.chargebee.com/docs/api/hosted_pages#checkout_new_subscription\n                            // If you want to use paypal, go cardless and plaid, pass embed parameter as false\n                            // Now we can continue...\n                            var promises = ajax.call([{\n                                methodname: 'block_poodllclassroom_get_checkout_existing',\n                                args: {planid: planid}\n                            }]);\n                            return promises[0];\n                        },\n                        loaded: function() {\n                            console.log(\"checkout opened\");\n                        },\n                        error: function() {\n                        },\n                        close: function() {\n                            console.log(\"checkout closed\");\n                        },\n                        success: function(hostedPageId) {\n                            console.log(hostedPageId);\n                            // Hosted page id will be unique token for the checkout that happened\n                            // You can pass this hosted page id to your backend\n                            // and then call our retrieve hosted page api to get subscription details\n                            // https://apidocs.chargebee.com/docs/api/hosted_pages#retrieve_a_hosted_page\n                        },\n                        step: function(value) {\n                            // value -> which step in checkout\n                            console.log(value);\n                        }\n                    });\n                });//on click\n\n            });//end of get script\n\n\n\n        }//end of reg events\n    };//end of returned object\n});//total end\n\n"],"file":"chargebeehelper.min.js"}