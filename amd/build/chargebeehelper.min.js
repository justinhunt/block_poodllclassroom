define("block_poodllclassroom/chargebeehelper",["jquery","core/log","core/ajax"],(function($,log,ajax){return log.debug("cbhelper: initialising"),{instanceprops:null,siteprefix:"",controls:{},init:function(props){this.instanceprops=props,this.siteprefix=props.siteprefix,this.gocbcheckoutclass=props.gocbcheckoutclass,this.gocbmanageclass=props.gocbmanageclass,this.registercontrols(),this.registerevents()},registercontrols:function(){this.controls.togglebutton=$("a.monthlyyearly"),this.controls.monthlyplans=$("div.monthly"),this.controls.yearlyplans=$("div.yearly")},registerevents:function(){var that=this;this.controls.togglebutton.on("click",(function(){event.preventDefault(),that.controls.monthlyplans.toggleClass("block_poodllclassroom_hidden"),that.controls.yearlyplans.toggleClass("block_poodllclassroom_hidden")})),$.getScript("https://js.chargebee.com/v2/chargebee.js",(function(){var chargebee=Chargebee.init({site:that.siteprefix});$("."+that.gocbcheckoutclass).on("click",(function(){event.preventDefault();var currency=$(this).data("currency"),billinginterval=$(this).data("billinginterval"),planid=$(this).data("planid"),schoolid=$(this).data("schoolid"),currentsubid=$(this).data("currentsubid"),method=$(this).data("method"),methodargs={planid:planid,schoolid:schoolid,currentsubid:currentsubid};if("get_checkout_new"===method)methodargs.currency=currency,methodargs.billinginterval=billinginterval;chargebee.openCheckout({hostedPage:function(){return ajax.call([{methodname:"block_poodllclassroom_"+method,args:methodargs}])[0]},loaded:function(){console.log("checkout opened")},error:function(){},close:function(){console.log("checkout closed")},success:function(hostedPageId){console.log(hostedPageId)},step:function(value){console.log(value)}})})),$("[data-cbaction='ssp']").on("click",(function(){event.preventDefault();var upstreamownerid=$(this).data("upstreamownerid"),upstreamsubid=$(this).data("upstreamsubid");switch($(this).data("type")){case"paymentsources":var sectiontype=Chargebee.getPortalSections().PAYMENT_SOURCES;break;case"billinghistory":sectiontype=Chargebee.getPortalSections().BILLING_HISTORY;break;case"subdetails":sectiontype=Chargebee.getPortalSections().SUBSCRIPTION_DETAILS;break;default:sectiontype=!1}chargebee.setPortalSession((function(){return ajax.call([{methodname:"block_poodllclassroom_create_portal_session",args:{upstreamownerid:upstreamownerid}}])[0]}));var cbPortal=chargebee.createChargebeePortal(),callbacks={loaded:function(){console.log("manage portal opened")},close:function(){console.log("manage portal closed")},visit:function(sectionType){console.log("manage portal visit")},paymentSourceAdd:function(){console.log("manage portal PSA")},paymentSourceUpdate:function(){console.log("manage portal PSU")},paymentSourceRemove:function(){console.log("manage portal PSR")},subscriptionChanged:function(data){console.log("manage portal sc")},subscriptionCustomFieldsChanged:function(data){console.log("manage portal scfc")},subscriptionCancelled:function(data){console.log("manage portal sub cancelled")},subscriptionPaused:function(data){console.log("manage portal sub paused")},subscriptionPauseRemoved:function(data){console.log("manage portal sub pause removed")},subscriptionResumed:function(data){console.log("manage portal sub resumed")},subscriptionReactivated:function(data){console.log("manage portal sub reactivated")}};if(!1!==sectiontype){var opts={sectionType:sectiontype,params:{subscriptionId:upstreamsubid}};cbPortal.openSection(opts,callbacks)}else{Chargebee.getPortalSections().ACCOUNT_DETAILS;cbPortal.open(callbacks)}})),$("[data-cbaction='pay_outstanding']").on("click",(function(){event.preventDefault();var methodargs={upstreamownerid:$(this).data("upstreamownerid")};ajax.call([{methodname:"block_poodllclassroom_get_pay_outstanding",args:methodargs}])[0].then((function(hostedpage){window.location.href=hostedpage.url}))}))}))}}}));

//# sourceMappingURL=chargebeehelper.min.js.map